<!DOCTYPE html>
<html>
<head>
    <meta charset=="UTF-8">
    <title>twenty_gogae</title>
    <meta name="viewport" content="width=device-width, height=device-height, minimum-scale=1.0, maximum-scale=1.0, initial-scale=1.0">
    <style>

    </style>
</head>
<body style="background-color: #ededed; padding: 0; margin: 0;">
    <div style="width: 780px; height: 550px; margin: 0 auto;" class="loginbox">
        <h2 style="width: 100%;">Login</h2>
        <form style="width: 100%; height: 450px; background-color: #fff; padding: 60px; box-sizing: border-box;" action="#" method="get">
            <fieldset style="border: none;">

                <label style="display: block; font-size: 12px; color: #333; margin-bottom: 10px;" for="nickname">nickname</label>
                <input style="width: 600px; display: block; height: 50px; margin-bottom: 25px; border: none; background-color: #ededed; padding: 0 20px; box-sizing: border-box;" type="text" id="nickname" placeholder="nickname">
                <input type="file" id="imagee">제출</input>
                <ul style="width: 100%; text-align: right; margin-bottom: 60px;">
                    <li style="display: inline-block; height: 12px; line-height: 12px; list-style: none;"><a style="color: #333; font-size: 12px; position: relative; top: -2px; text-decoration: none;" href="#">forgot id/pw?</a></li>
                </ul>
                <button style="display: block; width: 220px; height: 50px; margin: 0 auto; border: none; background-color: #1673ea; color: #fff; font-size: 14px; cursor: pointer;" type="button" onclick="tryLogIn();">Login</button>
            </fieldset>
        </form>
    </div>
    <script>


            function tryLogIn() {

                let name=document.querySelector("#nickname").value;



                let inputElement = document.getElementById("imagee");
                let file = inputElement.files[0];
                let reader = new FileReader();
                let result="none"
                reader.onloadend = function(){
                    fetch("/join", {
                  method: "POST",
                  headers: {
                    "Content-Type": "application/json",
                  },
                  body: JSON.stringify({
                    name: name,
                    profile: reader.result,
                    role:""
                  }),
                }).then((response)=>{
                    if (nickname == '') {
                        alert('input something!');
                    }
                    else location.href = `/manage?name=${name}`;
                    }
                )
                }
                reader.readAsDataURL(file)



            }
      </script>
</body>
</html>